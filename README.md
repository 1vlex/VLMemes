# VLMemes: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –º–µ–º–æ–≤ (VLM + CLIP)

> ‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏ –ø—Ä–∏–º–µ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–∞—è –∏ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞.  
> –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º–∞—Ç–∏–∫–æ–π —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –º–µ–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è *–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ* –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª—è—Ö
> –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –Ω–µ –æ—Ç—Ä–∞–∂–∞—é—Ç –ø–æ–∑–∏—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞.

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

Jupyter-–Ω–æ—É—Ç–±—É–∫ `VLMemes.ipynb`, –≤ –∫–æ—Ç–æ—Ä–æ–º –∏—Å—Å–ª–µ–¥—É–µ—Ç—Å—è,
–∫–∞–∫ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–º–∏ –º–µ–º–∞–º–∏ –∏ –æ—Ü–µ–Ω–∫–æ–π —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞:

1. **–°–±–æ—Ä –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–∞–ø–æ–∫** —Å –º–µ–º–∞–º–∏ (`–ù–µ–≥–∞—Ç–∏–≤–Ω–æ` / `–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ`) ‚Üí `annotations.csv`.
2. **–ü—Ä–µ–≤—å—é –¥–∞—Ç–∞—Å–µ—Ç–∞**: –≤–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∏–º–µ—Ä–æ–≤ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö –º–µ–º–æ–≤.
3. **OCR (easyocr)**: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–µ–º–æ–≤ (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫).
4. **VLM (Qwen2.5-VL-3B-Instruct)**:
   - —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –ø–æ–¥ –∑–∞–¥–∞—á—É –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞;
   - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –º–æ–¥–µ–ª–∏ (–∫–ª–∞—Å—Å + –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ);
   - –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç –º–µ—Ç–∫–∏ (`toxic` / `non_toxic`).
5. **CLIP (openai/clip-vit-large-patch14)**:
   - —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ (‚Äú—Ç–æ–∫—Å–∏—á–Ω—ã–π –º–µ–º‚Äù, ‚Äú–Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ–º‚Äù);
   - —É—á—ë—Ç OCR-—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤;
   - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–æ–≤ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é + —Ç–µ–∫—Å—Ç—É.
6. **–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π**:
   - accuracy, precision, recall, F1;
   - confusion matrix;
   - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ VLM vs CLIP –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –¥–∞—Ç–∞—Å–µ—Ç–µ.
7. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è CLIP (pytorch-grad-cam)**:
   - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ heatmap‚Äô–æ–≤ (EigenCAM) –ø–æ–≤–µ—Ä—Ö –º–µ–º–æ–≤;
   - –∞–Ω–∞–ª–∏–∑, –Ω–∞ –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/—Ç–µ–∫—Å—Ç–∞ –º–æ–¥–µ–ª—å —Å–º–æ—Ç—Ä–∏—Ç –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏.

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ - **—Ä–∞–∑–±–æ—Ä –ø–æ–≤–µ–¥–µ–Ω–∏—è VLM/CLIP –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º,
—Ä—É–∫–æ–ø–æ–¥–Ω—è—Ç–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –º–µ–º–æ–≤**, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å —Ç–æ–∫—Å–∏—á–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```text
.
‚îú‚îÄ VLMemes.ipynb          # –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–æ—É—Ç–±—É–∫ —Å –ø–æ–ª–Ω—ã–º –ø–∞–π–ø–ª–∞–π–Ω–æ–º
‚îú‚îÄ README.md              # —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ
‚îú‚îÄ requirements.txt       # Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ .gitignore             # –∏–≥–Ω–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```

–†–∞–±–æ—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Å –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—É—Ç–±—É–∫:

```text
/content/memes_project/           # BASE_DIR (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥ Colab)
‚îú‚îÄ memes/
‚îÇ   ‚îú‚îÄ –ù–µ–≥–∞—Ç–∏–≤–Ω–æ/                 # —Ç–æ–∫—Å–∏—á–Ω—ã–µ –º–µ–º—ã (toxic)
‚îÇ   ‚îî‚îÄ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ/                # –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –º–µ–º—ã (non_toxic)
‚îú‚îÄ annotations.csv                # —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (–ø—É—Ç—å + –º–µ—Ç–∫–∞)
‚îî‚îÄ artefacts/                     # —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è/—Ç–∞–±–ª–∏—Ü—ã/–≥—Ä–∞—Ñ–∏–∫–∏
```

> üîß –ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—à—å –Ω–æ—É—Ç–±—É–∫ **–ª–æ–∫–∞–ª—å–Ω–æ**, –º–æ–∂–Ω–æ:
> - –ª–∏–±–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–∫—É—é –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∫–∞–∫ `/content/memes_project/...`,
> - –ª–∏–±–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `BASE_DIR` –≤ –Ω–∞—á–∞–ª–µ –Ω–æ—É—Ç–±—É–∫–∞ –Ω–∞ –ø—É—Ç—å –≤ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º–µ,
>   –Ω–∞–ø—Ä–∏–º–µ—Ä:
>   ```python
>   BASE_DIR = Path("./memes_project")
>   ```

–°–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–º–æ–≤ (–≤ —Ç–æ–º —á–∏—Å–ª–µ —Å –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω–æ–π –ª–µ–∫—Å–∏–∫–æ–π) 

---

## –î–∞–Ω–Ω—ã–µ

- –í –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –º–µ–º–æ–≤,
  —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é –Ω–∞ –¥–≤–∞ –∫–ª–∞—Å—Å–∞:
  - `–ù–µ–≥–∞—Ç–∏–≤–Ω–æ` (toxic) - –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω–∞—è/–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è/—Ç–æ–∫—Å–∏—á–Ω–∞—è –ø–æ–¥–∞—á–∞;
  - `–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ` (non_toxic) - –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –∏–ª–∏ –±–µ–∑–æ–±–∏–¥–Ω—ã–µ –º–µ–º—ã.
- –£ –º–µ–Ω—è —ç—Ç–æ:
  - **26 –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö** –º–µ–º–æ–≤;
  - **25 –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö** –º–µ–º–æ–≤.

–î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–æ—É—Ç–±—É–∫:

1. –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –ø–∞–ø–∫–∞–º `–ù–µ–≥–∞—Ç–∏–≤–Ω–æ` –∏ `–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ`;
2. –°–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤;
3. –°—Ç—Ä–æ–∏—Ç `annotations.csv` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ –≤–∏–¥–∞:
   - `filename` ‚Äî –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `MEMES_DIR`;
   - `label` ‚Äî `toxic` / `non_toxic`.

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–û—Å–Ω–æ–≤–Ω—ã–µ Python-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–æ—É—Ç–±—É–∫–µ:

- `torch`, `torchvision`, `torchaudio` - —è–¥—Ä–æ PyTorch;
- `transformers`, `accelerate`, `bitsandbytes` - –º—É–ª—å—Ç–∏–º–æ–¥–µ–ª–∏ (Qwen2.5-VL) –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π inference;
- `numpy`, `pandas`;
- `matplotlib`;
- `scikit-learn` (–º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞, –æ—Ç—á—ë—Ç—ã);
- `opencv-python` (`cv2`) - —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏;
- `pillow` (`PIL`);
- `tqdm` - –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã;
- `easyocr` - OCR –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞;
- `pytorch-grad-cam` - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ (heatmap‚Äô—ã).

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–≤–µ–¥–µ–Ω—ã –≤ `requirements.txt`.

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/1vlex/VLMemes/tree/main.git
cd VLMemes

# 2. (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --upgrade pip
pip install -r requirements.txt

# 4. –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ
# —Å–æ–∑–¥–∞—ë–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –∏ –∫–ª–∞–¥—ë–º –º–µ–º—ã:
#   ./memes_project/memes/–ù–µ–≥–∞—Ç–∏–≤–Ω–æ/*.jpg
#   ./memes_project/memes/–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ/*.jpg
# –ª–∏–±–æ –º–µ–Ω—è–µ–º BASE_DIR –≤ –Ω–æ—É—Ç–±—É–∫–µ –Ω–∞ —Å–≤–æ—é –ø–∞–ø–∫—É

# 5. –ó–∞–ø—É—Å–∫–∞–µ–º Jupyter
jupyter notebook
# –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ—É—Ç–±—É–∫ "VLMemes.ipynb"
```

–î–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ Qwen2.5-VL-3B-Instruct –∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞ **GPU** —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –æ–±—ä—ë–º–æ–º –ø–∞–º—è—Ç–∏.
–ù–∞ CPU –º–æ–¥–µ–ª—å —Ç–æ–∂–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –Ω–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–º–µ—Ç–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ.

---

## –ü—Ä–æ Colab-—è—á–µ–π–∫—É —Å `pip install`

–í –Ω–æ—É—Ç–±—É–∫–µ –µ—Å—Ç—å —è—á–µ–π–∫–∞ –≤–∏–¥–∞:

```python
!pip -q install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
!pip -q install "transformers>=4.44.2" accelerate bitsandbytes datasets pillow scikit-learn matplotlib opencv-python pandas einops
!pip -q install easyocr

# –ø—Ä–æ–±—É–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pytorch-grad-cam...
...
```

–≠—Ç–∞ —è—á–µ–π–∫–∞ –Ω—É–∂–Ω–∞ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –¥–ª—è **–∑–∞–ø—É—Å–∫–∞ –≤ Google Colab**.

–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ —Å—Ç–∞–≤–∏—à—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `requirements.txt`, —Ç–æ:

- –Ø—á–µ–π–∫–∞ **–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞** –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å **—Å–ø–æ–∫–æ–π–Ω–æ —É–¥–∞–ª–µ–Ω–∞**


